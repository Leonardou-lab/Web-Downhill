<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Standings - Downhill M√©xico</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body class="page-light page-dark">
    <!-- Navigation Bar injected by navbar.js -->

    <!-- Main Content -->
    <main class="standings-page">
        <!-- Hero Section -->
        <section class="standings-hero">
            <div class="standings-hero-overlay"></div>
            <div class="standings-hero-content">
                <h1 class="standings-hero-title">Donde los grandes se levantan</h1>
                <p class="standings-hero-subtitle">El ranking definitivo de los mejores pilotos</p>
            </div>
        </section>

        <div class="standings-layout">
            <!-- Sidebar -->
            <aside class="standings-sidebar">
                <ul class="sidebar-menu">
                    <li><a href="#overall" class="sidebar-link active" data-view="overall">Overall</a></li>
                    <li><a href="#por-carrera" class="sidebar-link" data-view="por-carrera">Por carrera</a></li>
                </ul>
            </aside>

            <!-- Content Area -->
            <div class="standings-content">
                <!-- Vista Overall -->
                <div id="view-overall" class="standings-view view-active">
                    <h1 class="standings-title">Standings - Overall</h1>
                    
                    <!-- Elite -->
                    <div class="standings-category" data-category="elite">
                        <div class="category-header">
                            <h2 class="category-title">Elite</h2>
                            <a href="standings-detalle.html?categoria=elite" class="btn-ver-mas">Ver m√°s</a>
                        </div>
                        <div class="standings-table-wrapper">
                            <table class="standings-table">
                                <thead>
                                    <tr>
                                        <th>Pos</th>
                                        <th>Nombre</th>
                                        <th>Round 1<br><span class="sub-header">Puntos</span></th>
                                        <th>Round 2<br><span class="sub-header">Puntos</span></th>
                                        <th>Round 3<br><span class="sub-header">Puntos</span></th>
                                        <th class="text-right">Total</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody id="elite-top3">
                                    <tr>
                                        <td>1¬∞</td>
                                        <td><span>Carlos Mendoza</span></td>
                                        <td><span class="fin">20</span></td>
                                        <td><span class="fin">25</span></td>
                                        <td><span class="fin">25</span></td>
                                        <td class="text-right total">70</td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td>2¬∞</td>
                                        <td><span>Diego Ram√≠rez</span></td>
                                        <td><span class="fin">25</span></td>
                                        <td><span class="fin">16</span></td>
                                        <td><span class="fin">20</span></td>
                                        <td class="text-right total">61</td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td>3¬∞</td>
                                        <td><span>Roberto Silva</span></td>
                                        <td><span class="fin">16</span></td>
                                        <td><span class="fin">20</span></td>
                                        <td><span class="fin">16</span></td>
                                        <td class="text-right total">52</td>
                                        <td></td>
                                    </tr>
                                </tbody>
                                <tbody id="elite-full" style="display: none;"></tbody>
                            </table>
                        </div>
                        <div class="category-actions" id="elite-actions" style="display: none;">
                            <button class="btn-ver-menos" onclick="collapseCategory('elite')">Ver menos</button>
                        </div>
                    </div>

                    <!-- Infantil -->
                    <div class="standings-category" data-category="infantil">
                        <div class="category-header">
                            <h2 class="category-title">Infantil</h2>
                            <a href="standings-detalle.html?categoria=infantil" class="btn-ver-mas">Ver m√°s</a>
                        </div>
                        <div class="standings-table-wrapper">
                            <table class="standings-table">
                                <thead>
                                    <tr>
                                        <th>Pos</th>
                                        <th>Nombre</th>
                                        <th>Round 1<br><span class="sub-header">Puntos</span></th>
                                        <th>Round 2<br><span class="sub-header">Puntos</span></th>
                                        <th>Round 3<br><span class="sub-header">Puntos</span></th>
                                        <th class="text-right">Total</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody id="infantil-top3">
                                    <tr>
                                        <td>1¬∞</td>
                                        <td><span>Javier Torres</span></td>
                                        <td><span class="fin">25</span></td>
                                        <td><span class="fin">20</span></td>
                                        <td><span class="fin">25</span></td>
                                        <td class="text-right total">70</td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td>2¬∞</td>
                                        <td><span>Andr√©s L√≥pez</span></td>
                                        <td><span class="fin">20</span></td>
                                        <td><span class="fin">25</span></td>
                                        <td><span class="fin">20</span></td>
                                        <td class="text-right total">65</td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td>3¬∞</td>
                                        <td><span>Emilio Garc√≠a</span></td>
                                        <td><span class="fin">16</span></td>
                                        <td><span class="fin">16</span></td>
                                        <td><span class="fin">16</span></td>
                                        <td class="text-right total">48</td>
                                        <td></td>
                                    </tr>
                                </tbody>
                                <tbody id="infantil-full" style="display: none;"></tbody>
                            </table>
                            <div class="table-actions" id="infantil-button-container">
                                <a href="standings-detalle.html?categoria=infantil" class="btn-ver-mas">Ver m√°s</a>
                            </div>
                        </div>
                        <div class="category-actions" id="infantil-actions" style="display: none;">
                            <button class="btn-ver-menos" onclick="collapseCategory('infantil')">Ver menos</button>
                        </div>
                    </div>

                    <!-- Femenil Elite -->
                    <div class="standings-category" data-category="femenil-elite">
                        <div class="category-header">
                            <h2 class="category-title">Femenil Elite</h2>
                            <a href="standings-detalle.html?categoria=femenil-elite" class="btn-ver-mas">Ver m√°s</a>
                        </div>
                        <div class="standings-table-wrapper">
                            <table class="standings-table">
                                <thead>
                                    <tr>
                                        <th>Pos</th>
                                        <th>Nombre</th>
                                        <th>Round 1<br><span class="sub-header">Puntos</span></th>
                                        <th>Round 2<br><span class="sub-header">Puntos</span></th>
                                        <th>Round 3<br><span class="sub-header">Puntos</span></th>
                                        <th class="text-right">Total</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody id="femenil-elite-top3">
                                    <tr>
                                        <td>1¬∞</td>
                                        <td><span>Camila Aguilar</span></td>
                                        <td><span class="fin">25</span></td>
                                        <td><span class="fin">25</span></td>
                                        <td><span class="fin">20</span></td>
                                        <td class="text-right total">70</td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td>2¬∞</td>
                                        <td><span>Valeria Soto</span></td>
                                        <td><span class="fin">20</span></td>
                                        <td><span class="fin">20</span></td>
                                        <td><span class="fin">25</span></td>
                                        <td class="text-right total">65</td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td>3¬∞</td>
                                        <td><span>Fernanda Cruz</span></td>
                                        <td><span class="fin">16</span></td>
                                        <td><span class="fin">16</span></td>
                                        <td><span class="fin">16</span></td>
                                        <td class="text-right total">48</td>
                                        <td></td>
                                    </tr>
                                </tbody>
                                <tbody id="femenil-elite-full" style="display: none;"></tbody>
                            </table>
                            <div class="table-actions" id="femenil-elite-button-container">
                                <a href="standings-detalle.html?categoria=femenil-elite" class="btn-ver-mas">Ver m√°s</a>
                            </div>
                        </div>
                        <div class="category-actions" id="femenil-elite-actions" style="display: none;">
                            <button class="btn-ver-menos" onclick="collapseCategory('femenil-elite')">Ver menos</button>
                        </div>
                    </div>

                    <!-- Junior -->
                    <div class="standings-category" data-category="junior">
                        <div class="category-header">
                            <h2 class="category-title">Junior</h2>
                            <a href="standings-detalle.html?categoria=junior" class="btn-ver-mas">Ver m√°s</a>
                        </div>
                        <div class="standings-table-wrapper">
                            <table class="standings-table">
                                <thead>
                                    <tr>
                                        <th>Pos</th>
                                        <th>Nombre</th>
                                        <th>Round 1<br><span class="sub-header">Puntos</span></th>
                                        <th>Round 2<br><span class="sub-header">Puntos</span></th>
                                        <th>Round 3<br><span class="sub-header">Puntos</span></th>
                                        <th class="text-right">Total</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody id="junior-top3">
                                    <tr>
                                        <td>1¬∞</td>
                                        <td><span>Kaito Roldan</span></td>
                                        <td><span class="fin">25</span></td>
                                        <td><span class="fin">25</span></td>
                                        <td><span class="fin">25</span></td>
                                        <td class="text-right total">75</td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td>2¬∞</td>
                                        <td><span>Alex Mendoza</span></td>
                                        <td><span class="fin">20</span></td>
                                        <td><span class="fin">20</span></td>
                                        <td><span class="fin">20</span></td>
                                        <td class="text-right total">60</td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td>3¬∞</td>
                                        <td><span>Luis "Lucho" Le√≥n</span></td>
                                        <td><span class="fin">16</span></td>
                                        <td><span class="fin">16</span></td>
                                        <td><span class="fin">16</span></td>
                                        <td class="text-right total">48</td>
                                        <td></td>
                                    </tr>
                                </tbody>
                                <tbody id="junior-full" style="display: none;"></tbody>
                            </table>
                            <div class="table-actions" id="junior-button-container">
                                <a href="standings-detalle.html?categoria=junior" class="btn-ver-mas">Ver m√°s</a>
                            </div>
                        </div>
                        <div class="category-actions" id="junior-actions" style="display: none;">
                            <button class="btn-ver-menos" onclick="collapseCategory('junior')">Ver menos</button>
                        </div>
                    </div>

                    <!-- Master A -->
                    <div class="standings-category" data-category="master-a">
                        <div class="category-header">
                            <h2 class="category-title">Master A</h2>
                            <a href="standings-detalle.html?categoria=master-a" class="btn-ver-mas">Ver m√°s</a>
                        </div>
                        <div class="standings-table-wrapper">
                            <table class="standings-table">
                                <thead>
                                    <tr>
                                        <th>Pos</th>
                                        <th>Nombre</th>
                                        <th>Round 1<br><span class="sub-header">Puntos</span></th>
                                        <th>Round 2<br><span class="sub-header">Puntos</span></th>
                                        <th>Round 3<br><span class="sub-header">Puntos</span></th>
                                        <th class="text-right">Total</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody id="master-a-top3">
                                    <tr>
                                        <td>1¬∞</td>
                                        <td><span>Juan P√©rez</span></td>
                                        <td><span class="fin">25</span></td>
                                        <td><span class="fin">20</span></td>
                                        <td><span class="fin">25</span></td>
                                        <td class="text-right total">70</td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td>2¬∞</td>
                                        <td><span>Pedro Mart√≠nez</span></td>
                                        <td><span class="fin">20</span></td>
                                        <td><span class="fin">25</span></td>
                                        <td><span class="fin">20</span></td>
                                        <td class="text-right total">65</td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td>3¬∞</td>
                                        <td><span>Ra√∫l Hern√°ndez</span></td>
                                        <td><span class="fin">16</span></td>
                                        <td><span class="fin">16</span></td>
                                        <td><span class="fin">16</span></td>
                                        <td class="text-right total">48</td>
                                        <td></td>
                                    </tr>
                                </tbody>
                                <tbody id="master-a-full" style="display: none;"></tbody>
                            </table>
                            <div class="table-actions" id="master-a-button-container">
                                <a href="standings-detalle.html?categoria=master-a" class="btn-ver-mas">Ver m√°s</a>
                            </div>
                        </div>
                        <div class="category-actions" id="master-a-actions" style="display: none;">
                            <button class="btn-ver-menos" onclick="collapseCategory('master-a')">Ver menos</button>
                        </div>
                    </div>

                    <!-- Master B -->
                    <div class="standings-category" data-category="master-b">
                        <div class="category-header">
                            <h2 class="category-title">Master B</h2>
                            <a href="standings-detalle.html?categoria=master-b" class="btn-ver-mas">Ver m√°s</a>
                        </div>
                        <div class="standings-table-wrapper">
                            <table class="standings-table">
                                <thead>
                                    <tr>
                                        <th>Pos</th>
                                        <th>Nombre</th>
                                        <th>Round 1<br><span class="sub-header">Puntos</span></th>
                                        <th>Round 2<br><span class="sub-header">Puntos</span></th>
                                        <th>Round 3<br><span class="sub-header">Puntos</span></th>
                                        <th class="text-right">Total</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody id="master-b-top3">
                                    <tr>
                                        <td>1¬∞</td>
                                        <td><span>Manuel Rodr√≠guez</span></td>
                                        <td><span class="fin">20</span></td>
                                        <td><span class="fin">25</span></td>
                                        <td><span class="fin">25</span></td>
                                        <td class="text-right total">70</td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td>2¬∞</td>
                                        <td><span>Francisco G√≥mez</span></td>
                                        <td><span class="fin">25</span></td>
                                        <td><span class="fin">20</span></td>
                                        <td><span class="fin">20</span></td>
                                        <td class="text-right total">65</td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td>3¬∞</td>
                                        <td><span>Jos√© Morales</span></td>
                                        <td><span class="fin">16</span></td>
                                        <td><span class="fin">16</span></td>
                                        <td><span class="fin">16</span></td>
                                        <td class="text-right total">48</td>
                                        <td></td>
                                    </tr>
                                </tbody>
                                <tbody id="master-b-full" style="display: none;"></tbody>
                            </table>
                            <div class="table-actions" id="master-b-button-container">
                                <a href="standings-detalle.html?categoria=master-b" class="btn-ver-mas">Ver m√°s</a>
                            </div>
                        </div>
                        <div class="category-actions" id="master-b-actions" style="display: none;">
                            <button class="btn-ver-menos" onclick="collapseCategory('master-b')">Ver menos</button>
                        </div>
                    </div>

                    <!-- Master C -->
                    <div class="standings-category" data-category="master-c">
                        <div class="category-header">
                            <h2 class="category-title">Master C</h2>
                            <a href="standings-detalle.html?categoria=master-c" class="btn-ver-mas">Ver m√°s</a>
                        </div>
                        <div class="standings-table-wrapper">
                            <table class="standings-table">
                                <thead>
                                    <tr>
                                        <th>Pos</th>
                                        <th>Nombre</th>
                                        <th>Round 1<br><span class="sub-header">Puntos</span></th>
                                        <th>Round 2<br><span class="sub-header">Puntos</span></th>
                                        <th>Round 3<br><span class="sub-header">Puntos</span></th>
                                        <th class="text-right">Total</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody id="master-c-top3">
                                    <tr>
                                        <td>1¬∞</td>
                                        <td><span>Alberto S√°nchez</span></td>
                                        <td><span class="fin">25</span></td>
                                        <td><span class="fin">25</span></td>
                                        <td><span class="fin">20</span></td>
                                        <td class="text-right total">70</td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td>2¬∞</td>
                                        <td><span>Enrique Vargas</span></td>
                                        <td><span class="fin">20</span></td>
                                        <td><span class="fin">20</span></td>
                                        <td><span class="fin">25</span></td>
                                        <td class="text-right total">65</td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td>3¬∞</td>
                                        <td><span>√ìscar Jim√©nez</span></td>
                                        <td><span class="fin">16</span></td>
                                        <td><span class="fin">16</span></td>
                                        <td><span class="fin">16</span></td>
                                        <td class="text-right total">48</td>
                                        <td></td>
                                    </tr>
                                </tbody>
                                <tbody id="master-c-full" style="display: none;"></tbody>
                            </table>
                            <div class="table-actions" id="master-c-button-container">
                                <a href="standings-detalle.html?categoria=master-c" class="btn-ver-mas">Ver m√°s</a>
                            </div>
                        </div>
                        <div class="category-actions" id="master-c-actions" style="display: none;">
                            <button class="btn-ver-menos" onclick="collapseCategory('master-c')">Ver menos</button>
                        </div>
                    </div>
                </div>

                <!-- Vista Por Carrera -->
                <div id="view-por-carrera" class="standings-view">
                    <h1 class="standings-title">Standings - Por Carrera</h1>
                    <ul class="race-accordion" id="race-accordion">
                        <!-- Will be populated by JS -->
                    </ul>
                </div>

            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <p class="footer-copyright">Copyright Downhill M√©xico</p>
        <div class="footer-social">
            <a href="#" class="social-icon instagram" aria-label="Instagram">
                üì∑
            </a>
            <a href="#" class="social-icon facebook" aria-label="Facebook">
                üìò
            </a>
        </div>
    </footer>

    <script src="navbar.js"></script>
    <script>
        // Sidebar Navigation
        const sidebarLinks = document.querySelectorAll('.sidebar-link');
        const views = document.querySelectorAll('.standings-view');

        sidebarLinks.forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const targetView = this.getAttribute('data-view');
                
                // Update active state
                sidebarLinks.forEach(l => l.classList.remove('active'));
                this.classList.add('active');
                
                // Hide all views
                views.forEach(v => v.classList.remove('view-active'));
                
                // Show target view
                const targetElement = document.getElementById('view-' + targetView);
                if (targetElement) {
                    setTimeout(() => {
                        targetElement.classList.add('view-active');
                        if (targetView === 'por-carrera') {
                            initRaceAccordion();
                        }
                    }, 10);
                }
            });
        });

        // Category data for Top 20 expansion
        const categoryData = {
            'elite': ['Carlos Mendoza', 'Diego Ram√≠rez', 'Roberto Silva', 'Fernando Cruz', 'Luis Gonz√°lez', 'Miguel Torres', 'Andr√©s Moreno', 'Jos√© Mart√≠nez', 'Carlos Ruiz', 'David L√≥pez', 'Roberto P√©rez', 'Juan D√≠az', 'Pedro S√°nchez', 'Luis Garc√≠a', 'Manuel Fern√°ndez', 'Ricardo Mart√≠nez', 'Fernando √Ålvarez', 'Carlos Vega', 'Diego Morales', 'Roberto Castro'],
            'infantil': ['Javier Torres', 'Andr√©s L√≥pez', 'Emilio Garc√≠a', 'Miguel S√°nchez', 'Luis Mendoza', 'Carlos Herrera', 'Diego Vega', 'Roberto M√©ndez', 'Juan P√©rez', 'Pedro Ram√≠rez', 'Fernando Cruz', 'Luis Gonz√°lez', 'Miguel Torres', 'Andr√©s Moreno', 'Jos√© Mart√≠nez', 'Carlos Ruiz', 'David L√≥pez', 'Roberto P√©rez', 'Juan D√≠az', 'Pedro S√°nchez'],
            'femenil-elite': ['Camila Aguilar', 'Valeria Soto', 'Fernanda Cruz', 'Mariana Torres', 'Sof√≠a Hern√°ndez', 'Ana Mart√≠nez', 'Laura Gonz√°lez', 'Paola Ram√≠rez', 'Daniela L√≥pez', 'Mar√≠a P√©rez', 'Gabriela D√≠az', 'Carolina S√°nchez', 'Andrea Vega', 'Natalia Morales', 'Isabella Castro', 'Valentina Ruiz', 'Regina Fern√°ndez', 'Diana √Ålvarez', 'Alejandra M√©ndez', 'Claudia Herrera'],
            'junior': ['Kaito Roldan', 'Alex Mendoza', 'Luis "Lucho" Le√≥n', 'Ricardo Vargas', 'Fernando Cruz', 'Miguel Torres', 'Andr√©s Moreno', 'Jos√© Mart√≠nez', 'Carlos Ruiz', 'David L√≥pez', 'Roberto P√©rez', 'Juan D√≠az', 'Pedro S√°nchez', 'Luis Garc√≠a', 'Manuel Fern√°ndez', 'Ricardo Mart√≠nez', 'Fernando √Ålvarez', 'Carlos Vega', 'Diego Morales', 'Roberto Castro'],
            'master-a': ['Juan P√©rez', 'Pedro Mart√≠nez', 'Ra√∫l Hern√°ndez', 'Manuel D√≠az', 'Eduardo Pacheco', 'Ricardo L√≥pez', 'Fernando S√°nchez', 'Luis Gonz√°lez', 'Miguel Torres', 'Andr√©s Moreno', 'Jos√© Mart√≠nez', 'Carlos Ruiz', 'David L√≥pez', 'Roberto P√©rez', 'Juan D√≠az', 'Pedro S√°nchez', 'Luis Garc√≠a', 'Manuel Fern√°ndez', 'Ricardo Mart√≠nez', 'Fernando √Ålvarez'],
            'master-b': ['Manuel Rodr√≠guez', 'Francisco G√≥mez', 'Jos√© Morales', 'Eduardo Pacheco', 'Ricardo L√≥pez', 'Fernando S√°nchez', 'Luis Gonz√°lez', 'Miguel Torres', 'Andr√©s Moreno', 'Jos√© Mart√≠nez', 'Carlos Ruiz', 'David L√≥pez', 'Roberto P√©rez', 'Juan D√≠az', 'Pedro S√°nchez', 'Luis Garc√≠a', 'Manuel Fern√°ndez', 'Ricardo Mart√≠nez', 'Fernando √Ålvarez', 'Carlos Vega'],
            'master-c': ['Alberto S√°nchez', 'Enrique Vargas', '√ìscar Jim√©nez', 'Jorge Ram√≠rez', 'Miguel Hern√°ndez', 'Carlos Morales', 'Roberto Castro', 'Luis Gonz√°lez', 'Miguel Torres', 'Andr√©s Moreno', 'Jos√© Mart√≠nez', 'Carlos Ruiz', 'David L√≥pez', 'Roberto P√©rez', 'Juan D√≠az', 'Pedro S√°nchez', 'Luis Garc√≠a', 'Manuel Fern√°ndez', 'Ricardo Mart√≠nez', 'Fernando √Ålvarez']
        };

        // Generate round times (dummy data)
        function generateTime(base, position) {
            const seconds = base + (position * 0.25) + (Math.random() * 0.3);
            const mins = Math.floor(seconds / 60);
            const secs = (seconds % 60).toFixed(2);
            return mins + ':' + (secs < 10 ? '0' : '') + secs;
        }
        
        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = (seconds % 60).toFixed(2);
            return mins + ':' + (secs < 10 ? '0' : '') + secs;
        }

        // Get category ID helper
        function getCategoryId(category) {
            return category;
        }

        // Expand category to Top 20
        function expandCategory(category) {
            const top3Body = document.getElementById(getCategoryId(category) + '-top3');
            const fullBody = document.getElementById(getCategoryId(category) + '-full');
            const actions = document.getElementById(getCategoryId(category) + '-actions');
            
            if (!top3Body || !fullBody) return;
            
            if (!fullBody.hasChildNodes() || fullBody.children.length === 0) {
                // Generate rows 4-20 with points instead of times
                const names = categoryData[category] || [];
                let html = '';
                
                // Function to convert position to points
                function getPoints(position) {
                    const pointsMap = {
                        1: 25, 2: 20, 3: 16, 4: 13, 5: 11,
                        6: 10, 7: 9, 8: 8, 9: 7, 10: 6,
                        11: 5, 12: 5, 13: 4, 14: 4, 15: 3,
                        16: 3, 17: 2, 18: 2, 19: 1, 20: 1
                    };
                    return pointsMap[position] || 1;
                }
                
                let totalPoints = 0;
                for (let i = 4; i <= 20; i++) {
                    const name = names[i - 1] || `Atleta ${i}`;
                    const p1 = getPoints(i);
                    const p2 = getPoints(i);
                    const p3 = getPoints(i);
                    const total = p1 + p2 + p3;
                    totalPoints = total;
                    
                    html += `
                        <tr>
                            <td>${i}¬∞</td>
                            <td><a href="atleta.html?name=${encodeURIComponent(name)}">${name}</a></td>
                            <td><span class="fin">${p1}</span></td>
                            <td><span class="fin">${p2}</span></td>
                            <td><span class="fin">${p3}</span></td>
                            <td class="text-right total">${total}</td>
                        </tr>
                    `;
                }
                
                fullBody.innerHTML = html;
            }
            
            // Hide preview row and show full table
            const previewRow = top3Body.querySelector('.row-preview');
            if (previewRow) {
                previewRow.style.display = 'none';
            }
            
            fullBody.style.display = 'table-row-group';
            if (actions) {
                actions.style.display = 'block';
            }
            
            // Scroll to category
            const categoryEl = document.querySelector(`[data-category="${category}"]`);
            if (categoryEl) {
                categoryEl.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }
        }

        // Collapse category to Top 3
        function collapseCategory(category) {
            const top3Body = document.getElementById(getCategoryId(category) + '-top3');
            const fullBody = document.getElementById(getCategoryId(category) + '-full');
            const actions = document.getElementById(getCategoryId(category) + '-actions');
            
            if (!top3Body) return;
            
            const previewRow = top3Body.querySelector('.row-preview');
            if (previewRow) {
                previewRow.style.display = '';
            }
            
            if (fullBody) {
                fullBody.style.display = 'none';
            }
            
            if (actions) {
                actions.style.display = 'none';
            }
        }

        // Datos compartidos de carreras pasadas (igual que en carreras.html)
        const pastRaceData = {
            'ajusco-2023': {
                name: 'Ajusco',
                date: 'Enero 15, 2023',
                categories: {
                    'elite': [
                        { pos: 1, name: 'Carlos Mendoza', time: '1:45.23' },
                        { pos: 2, name: 'Diego Ram√≠rez', time: '1:46.12' },
                        { pos: 3, name: 'Roberto Silva', time: '1:47.45' }
                    ],
                    'infantil': [
                        { pos: 1, name: 'Javier Torres', time: '2:15.34' },
                        { pos: 2, name: 'Andr√©s L√≥pez', time: '2:16.89' },
                        { pos: 3, name: 'Emilio Garc√≠a', time: '2:17.23' }
                    ],
                    'femenil-elite': [
                        { pos: 1, name: 'Camila Aguilar', time: '1:52.34' },
                        { pos: 2, name: 'Valeria Soto', time: '1:53.45' },
                        { pos: 3, name: 'Fernanda Cruz', time: '1:54.67' }
                    ],
                    'junior': [
                        { pos: 1, name: 'Kaito Roldan', time: '1:58.23' },
                        { pos: 2, name: 'Alex Mendoza', time: '1:59.34' },
                        { pos: 3, name: 'Luis "Lucho" Le√≥n', time: '2:00.12' }
                    ],
                    'master-a': [
                        { pos: 1, name: 'Juan P√©rez', time: '2:05.45' },
                        { pos: 2, name: 'Pedro Mart√≠nez', time: '2:06.78' },
                        { pos: 3, name: 'Ra√∫l Hern√°ndez', time: '2:07.12' }
                    ],
                    'master-b': [
                        { pos: 1, name: 'Manuel Rodr√≠guez', time: '2:12.34' },
                        { pos: 2, name: 'Francisco G√≥mez', time: '2:13.67' },
                        { pos: 3, name: 'Jos√© Morales', time: '2:14.89' }
                    ],
                    'master-c': [
                        { pos: 1, name: 'Alberto S√°nchez', time: '2:18.45' },
                        { pos: 2, name: 'Enrique Vargas', time: '2:19.67' },
                        { pos: 3, name: '√ìscar Jim√©nez', time: '2:20.12' }
                    ]
                }
            },
            'guanajuato-2023': {
                name: 'Guanajuato',
                date: 'Marzo 20, 2023',
                categories: {
                    'elite': [
                        { pos: 1, name: 'Diego Ram√≠rez', time: '1:44.12' },
                        { pos: 2, name: 'Carlos Mendoza', time: '1:45.89' },
                        { pos: 3, name: 'Roberto Silva', time: '1:46.34' }
                    ],
                    'infantil': [
                        { pos: 1, name: 'Andr√©s L√≥pez', time: '2:14.23' },
                        { pos: 2, name: 'Javier Torres', time: '2:15.67' },
                        { pos: 3, name: 'Emilio Garc√≠a', time: '2:16.45' }
                    ],
                    'femenil-elite': [
                        { pos: 1, name: 'Valeria Soto', time: '1:50.45' },
                        { pos: 2, name: 'Camila Aguilar', time: '1:51.23' },
                        { pos: 3, name: 'Fernanda Cruz', time: '1:52.89' }
                    ],
                    'junior': [
                        { pos: 1, name: 'Alex Mendoza', time: '1:57.67' },
                        { pos: 2, name: 'Kaito Roldan', time: '1:58.45' },
                        { pos: 3, name: 'Luis "Lucho" Le√≥n', time: '1:59.12' }
                    ],
                    'master-a': [
                        { pos: 1, name: 'Pedro Mart√≠nez', time: '2:03.89' },
                        { pos: 2, name: 'Juan P√©rez', time: '2:04.23' },
                        { pos: 3, name: 'Ra√∫l Hern√°ndez', time: '2:05.45' }
                    ],
                    'master-b': [
                        { pos: 1, name: 'Francisco G√≥mez', time: '2:11.23' },
                        { pos: 2, name: 'Manuel Rodr√≠guez', time: '2:12.67' },
                        { pos: 3, name: 'Jos√© Morales', time: '2:13.45' }
                    ],
                    'master-c': [
                        { pos: 1, name: 'Enrique Vargas', time: '2:17.34' },
                        { pos: 2, name: 'Alberto S√°nchez', time: '2:18.89' },
                        { pos: 3, name: '√ìscar Jim√©nez', time: '2:19.23' }
                    ]
                }
            },
            'atlixco-2023': {
                name: 'Atlixco',
                date: 'Mayo 10, 2023',
                categories: {
                    'elite': [
                        { pos: 1, name: 'Roberto Silva', time: '1:43.12' },
                        { pos: 2, name: 'Carlos Mendoza', time: '1:44.56' },
                        { pos: 3, name: 'Diego Ram√≠rez', time: '1:45.78' }
                    ],
                    'infantil': [
                        { pos: 1, name: 'Emilio Garc√≠a', time: '2:15.78' },
                        { pos: 2, name: 'Javier Torres', time: '2:16.34' },
                        { pos: 3, name: 'Andr√©s L√≥pez', time: '2:17.12' }
                    ],
                    'femenil-elite': [
                        { pos: 1, name: 'Camila Aguilar', time: '1:49.89' },
                        { pos: 2, name: 'Fernanda Cruz', time: '1:52.12' },
                        { pos: 3, name: 'Valeria Soto', time: '1:53.45' }
                    ],
                    'junior': [
                        { pos: 1, name: 'Luis "Lucho" Le√≥n', time: '1:57.45' },
                        { pos: 2, name: 'Kaito Roldan', time: '1:58.23' },
                        { pos: 3, name: 'Alex Mendoza', time: '1:59.67' }
                    ],
                    'master-a': [
                        { pos: 1, name: 'Ra√∫l Hern√°ndez', time: '2:05.89' },
                        { pos: 2, name: 'Juan P√©rez', time: '2:06.34' },
                        { pos: 3, name: 'Pedro Mart√≠nez', time: '2:07.12' }
                    ],
                    'master-b': [
                        { pos: 1, name: 'Jos√© Morales', time: '2:11.67' },
                        { pos: 2, name: 'Manuel Rodr√≠guez', time: '2:12.89' },
                        { pos: 3, name: 'Francisco G√≥mez', time: '2:13.34' }
                    ],
                    'master-c': [
                        { pos: 1, name: '√ìscar Jim√©nez', time: '2:17.45' },
                        { pos: 2, name: 'Enrique Vargas', time: '2:18.67' },
                        { pos: 3, name: 'Alberto S√°nchez', time: '2:19.23' }
                    ]
                }
            },
            'valle-bravo-2023': {
                name: 'Valle de Bravo',
                date: 'Junio 2, 2023',
                categories: {
                    'elite': [
                        { pos: 1, name: 'Carlos Mendoza', time: '1:41.89' },
                        { pos: 2, name: 'Diego Ram√≠rez', time: '1:42.45' },
                        { pos: 3, name: 'Roberto Silva', time: '1:43.12' }
                    ],
                    'infantil': [
                        { pos: 1, name: 'Javier Torres', time: '2:13.45' },
                        { pos: 2, name: 'Andr√©s L√≥pez', time: '2:14.67' },
                        { pos: 3, name: 'Emilio Garc√≠a', time: '2:15.78' }
                    ],
                    'femenil-elite': [
                        { pos: 1, name: 'Valeria Soto', time: '1:50.45' },
                        { pos: 2, name: 'Camila Aguilar', time: '1:51.23' },
                        { pos: 3, name: 'Fernanda Cruz', time: '1:52.89' }
                    ],
                    'junior': [
                        { pos: 1, name: 'Kaito Roldan', time: '1:55.12' },
                        { pos: 2, name: 'Alex Mendoza', time: '1:56.89' },
                        { pos: 3, name: 'Luis "Lucho" Le√≥n', time: '1:57.45' }
                    ],
                    'master-a': [
                        { pos: 1, name: 'Juan P√©rez', time: '2:03.67' },
                        { pos: 2, name: 'Pedro Mart√≠nez', time: '2:04.23' },
                        { pos: 3, name: 'Ra√∫l Hern√°ndez', time: '2:05.89' }
                    ],
                    'master-b': [
                        { pos: 1, name: 'Manuel Rodr√≠guez', time: '2:09.45' },
                        { pos: 2, name: 'Francisco G√≥mez', time: '2:10.78' },
                        { pos: 3, name: 'Jos√© Morales', time: '2:11.67' }
                    ],
                    'master-c': [
                        { pos: 1, name: 'Alberto S√°nchez', time: '2:16.12' },
                        { pos: 2, name: 'Enrique Vargas', time: '2:15.89' },
                        { pos: 3, name: '√ìscar Jim√©nez', time: '2:17.45' }
                    ]
                }
            },
            'taxco-urbano-2023': {
                name: 'Taxco Urbano',
                date: 'Julio 13, 2023',
                categories: {
                    'elite': [
                        { pos: 1, name: 'Diego Ram√≠rez', time: '1:42.15' },
                        { pos: 2, name: 'Carlos Mendoza', time: '1:43.45' },
                        { pos: 3, name: 'Roberto Silva', time: '1:44.12' }
                    ],
                    'infantil': [
                        { pos: 1, name: 'Andr√©s L√≥pez', time: '2:14.89' },
                        { pos: 2, name: 'Javier Torres', time: '2:15.34' },
                        { pos: 3, name: 'Emilio Garc√≠a', time: '2:16.12' }
                    ],
                    'femenil-elite': [
                        { pos: 1, name: 'Camila Aguilar', time: '1:50.12' },
                        { pos: 2, name: 'Valeria Soto', time: '1:51.45' },
                        { pos: 3, name: 'Fernanda Cruz', time: '1:52.67' }
                    ],
                    'junior': [
                        { pos: 1, name: 'Alex Mendoza', time: '1:56.45' },
                        { pos: 2, name: 'Kaito Roldan', time: '1:57.23' },
                        { pos: 3, name: 'Luis "Lucho" Le√≥n', time: '1:58.34' }
                    ],
                    'master-a': [
                        { pos: 1, name: 'Pedro Mart√≠nez', time: '2:04.12' },
                        { pos: 2, name: 'Juan P√©rez', time: '2:05.45' },
                        { pos: 3, name: 'Ra√∫l Hern√°ndez', time: '2:06.78' }
                    ],
                    'master-b': [
                        { pos: 1, name: 'Francisco G√≥mez', time: '2:10.89' },
                        { pos: 2, name: 'Manuel Rodr√≠guez', time: '2:11.23' },
                        { pos: 3, name: 'Jos√© Morales', time: '2:12.45' }
                    ],
                    'master-c': [
                        { pos: 1, name: 'Enrique Vargas', time: '2:16.89' },
                        { pos: 2, name: 'Alberto S√°nchez', time: '2:17.34' },
                        { pos: 3, name: '√ìscar Jim√©nez', time: '2:18.67' }
                    ]
                }
            },
            'puebla-dh-2023': {
                name: 'Puebla DH',
                date: 'Septiembre 7, 2023',
                categories: {
                    'elite': [
                        { pos: 1, name: 'Carlos Mendoza', time: '1:42.98' },
                        { pos: 2, name: 'Roberto Silva', time: '1:43.67' },
                        { pos: 3, name: 'Diego Ram√≠rez', time: '1:44.23' }
                    ],
                    'infantil': [
                        { pos: 1, name: 'Javier Torres', time: '2:14.23' },
                        { pos: 2, name: 'Emilio Garc√≠a', time: '2:15.45' },
                        { pos: 3, name: 'Andr√©s L√≥pez', time: '2:16.67' }
                    ],
                    'femenil-elite': [
                        { pos: 1, name: 'Fernanda Cruz', time: '1:52.12' },
                        { pos: 2, name: 'Camila Aguilar', time: '1:53.23' },
                        { pos: 3, name: 'Valeria Soto', time: '1:54.45' }
                    ],
                    'junior': [
                        { pos: 1, name: 'Kaito Roldan', time: '1:57.34' },
                        { pos: 2, name: 'Luis "Lucho" Le√≥n', time: '1:58.67' },
                        { pos: 3, name: 'Alex Mendoza', time: '1:59.23' }
                    ],
                    'master-a': [
                        { pos: 1, name: 'Juan P√©rez', time: '2:04.56' },
                        { pos: 2, name: 'Ra√∫l Hern√°ndez', time: '2:05.23' },
                        { pos: 3, name: 'Pedro Mart√≠nez', time: '2:06.12' }
                    ],
                    'master-b': [
                        { pos: 1, name: 'Manuel Rodr√≠guez', time: '2:10.45' },
                        { pos: 2, name: 'Jos√© Morales', time: '2:11.67' },
                        { pos: 3, name: 'Francisco G√≥mez', time: '2:12.34' }
                    ],
                    'master-c': [
                        { pos: 1, name: 'Alberto S√°nchez', time: '2:16.45' },
                        { pos: 2, name: '√ìscar Jim√©nez', time: '2:17.89' },
                        { pos: 3, name: 'Enrique Vargas', time: '2:18.23' }
                    ]
                }
            },
            'tepoztlan-2023': {
                name: 'Tepoztl√°n',
                date: 'Octubre 12, 2023',
                categories: {
                    'elite': [
                        { pos: 1, name: 'Roberto Silva', time: '1:43.12' },
                        { pos: 2, name: 'Carlos Mendoza', time: '1:44.45' },
                        { pos: 3, name: 'Diego Ram√≠rez', time: '1:45.67' }
                    ],
                    'infantil': [
                        { pos: 1, name: 'Andr√©s L√≥pez', time: '2:13.89' },
                        { pos: 2, name: 'Javier Torres', time: '2:14.56' },
                        { pos: 3, name: 'Emilio Garc√≠a', time: '2:15.23' }
                    ],
                    'femenil-elite': [
                        { pos: 1, name: 'Valeria Soto', time: '1:51.23' },
                        { pos: 2, name: 'Camila Aguilar', time: '1:52.45' },
                        { pos: 3, name: 'Fernanda Cruz', time: '1:53.67' }
                    ],
                    'junior': [
                        { pos: 1, name: 'Alex Mendoza', time: '1:56.89' },
                        { pos: 2, name: 'Kaito Roldan', time: '1:57.45' },
                        { pos: 3, name: 'Luis "Lucho" Le√≥n', time: '1:58.12' }
                    ],
                    'master-a': [
                        { pos: 1, name: 'Pedro Mart√≠nez', time: '2:03.89' },
                        { pos: 2, name: 'Juan P√©rez', time: '2:04.67' },
                        { pos: 3, name: 'Ra√∫l Hern√°ndez', time: '2:05.23' }
                    ],
                    'master-b': [
                        { pos: 1, name: 'Francisco G√≥mez', time: '2:09.67' },
                        { pos: 2, name: 'Manuel Rodr√≠guez', time: '2:10.23' },
                        { pos: 3, name: 'Jos√© Morales', time: '2:11.45' }
                    ],
                    'master-c': [
                        { pos: 1, name: 'Enrique Vargas', time: '2:15.89' },
                        { pos: 2, name: 'Alberto S√°nchez', time: '2:16.34' },
                        { pos: 3, name: '√ìscar Jim√©nez', time: '2:17.67' }
                    ]
                }
            },
            'zacatlan-2023': {
                name: 'Zacatl√°n',
                date: 'Diciembre 1, 2023',
                categories: {
                    'elite': [
                        { pos: 1, name: 'Carlos Mendoza', time: '1:41.89' },
                        { pos: 2, name: 'Diego Ram√≠rez', time: '1:42.45' },
                        { pos: 3, name: 'Roberto Silva', time: '1:43.12' }
                    ],
                    'infantil': [
                        { pos: 1, name: 'Javier Torres', time: '2:13.45' },
                        { pos: 2, name: 'Andr√©s L√≥pez', time: '2:14.67' },
                        { pos: 3, name: 'Emilio Garc√≠a', time: '2:15.78' }
                    ],
                    'femenil-elite': [
                        { pos: 1, name: 'Camila Aguilar', time: '1:49.89' },
                        { pos: 2, name: 'Valeria Soto', time: '1:50.45' },
                        { pos: 3, name: 'Fernanda Cruz', time: '1:52.12' }
                    ],
                    'junior': [
                        { pos: 1, name: 'Kaito Roldan', time: '1:55.12' },
                        { pos: 2, name: 'Alex Mendoza', time: '1:56.89' },
                        { pos: 3, name: 'Luis "Lucho" Le√≥n', time: '1:57.45' }
                    ],
                    'master-a': [
                        { pos: 1, name: 'Juan P√©rez', time: '2:03.67' },
                        { pos: 2, name: 'Pedro Mart√≠nez', time: '2:04.23' },
                        { pos: 3, name: 'Ra√∫l Hern√°ndez', time: '2:05.89' }
                    ],
                    'master-b': [
                        { pos: 1, name: 'Manuel Rodr√≠guez', time: '2:09.45' },
                        { pos: 2, name: 'Francisco G√≥mez', time: '2:10.78' },
                        { pos: 3, name: 'Jos√© Morales', time: '2:11.67' }
                    ],
                    'master-c': [
                        { pos: 1, name: 'Alberto S√°nchez', time: '2:16.12' },
                        { pos: 2, name: 'Enrique Vargas', time: '2:15.89' },
                        { pos: 3, name: '√ìscar Jim√©nez', time: '2:17.45' }
                    ]
                }
            }
        };

        // Initialize race accordion using shared pastRaceData
        function initRaceAccordion() {
            const accordion = document.getElementById('race-accordion');
            if (!accordion) return;

            const categoryNames = {
                'elite': 'Elite',
                'infantil': 'Infantil',
                'femenil-elite': 'Femenil Elite',
                'junior': 'Junior',
                'master-a': 'Master A',
                'master-b': 'Master B',
                'master-c': 'Master C'
            };

            accordion.innerHTML = Object.keys(pastRaceData).map(raceId => {
                const race = pastRaceData[raceId];

                let categoryCards = '';
                Object.keys(race.categories).forEach(catKey => {
                    const category = race.categories[catKey];
                    const catName = categoryNames[catKey] || catKey;

                    categoryCards += `
                        <a href="race-category.html?race=${raceId}&categoria=${catKey}" class="category-card-link">
                            <div class="category-card">
                                <h3>${catName}</h3>
                            </div>
                        </a>
                    `;
                });

                return `
                    <li class="race-item" data-race="${raceId}">
                        <div class="race-header" onclick="toggleRace('${raceId}')">
                            <span>${race.name} - ${race.date}</span>
                        </div>
                        <div class="race-content">
                            <div class="categories-list">
                                ${categoryCards}
                            </div>
                        </div>
                    </li>
                `;
            }).join('');
        }

        // Toggle race accordion
        function toggleRace(raceId) {
            const raceItem = document.querySelector(`[data-race="${raceId}"]`);
            if (!raceItem) return;
            
            const isActive = raceItem.classList.contains('active');
            
            // Close all races
            document.querySelectorAll('.race-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Open clicked race if it wasn't active
            if (!isActive) {
                raceItem.classList.add('active');
            }
        }

        // Show overall category

        // Initialize on load
        document.addEventListener('DOMContentLoaded', function() {
            initRaceAccordion();
        });
    </script>
</body>
</html>
